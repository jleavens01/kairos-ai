# 업스케일 파일 백업 대안 방법 분석

## 📊 현재 상황
- **총 업스케일 파일**: 19개 (약 6GB)
- **평균 파일 크기**: 약 200-300MB
- **Supabase Storage 제한**: 250MB (Pro 플랜)
- **백업 실패 원인**: 파일 크기 제한

## 🔧 대안 방법들

### 1. 압축 백업 방법 (권장)
**장점**: 파일 크기 50-70% 감소 가능
**방법**: 
- FFmpeg를 사용한 무손실 압축
- H.264 → H.265 변환으로 크기 감소
- 품질 유지하면서 파일 크기 줄임

**구현 방안**:
```javascript
// 압축 후 백업하는 함수 추가
async function compressAndBackupVideo(videoUrl, fileName) {
  // 1. 원본 다운로드
  // 2. FFmpeg로 압축 (H.265, CRF 23)
  // 3. 압축된 파일을 Supabase에 업로드
  // 4. 임시 파일 삭제
}
```

### 2. Google Drive API 방법
**장점**: 15GB 무료 저장소, 큰 파일 지원
**단점**: 공유 권한 제한, 복잡한 API

**구현 상태**: 
- ✅ Service Account 설정 완료
- ❌ 저장소 할당량 문제로 보류

### 3. 외부 클라우드 스토리지
**장점**: 저렴하고 안정적
**대안**: 
- AWS S3 (Glacier Deep Archive)
- Azure Blob Storage (Cool Tier)
- Google Cloud Storage (Coldline)

### 4. 로컬 백업 + 클라우드 동기화
**장점**: 즉시 백업 가능
**방법**:
- 로컬 NAS/외장하드에 백업
- 클라우드 동기화 도구 사용

### 5. 파일 분할 백업
**방법**: 큰 파일을 여러 조각으로 분할
**단점**: 복원 시 조립 필요

## 🎯 추천 방안

### 단기 해결책 (즉시 실행 가능)
1. **50MB 미만 업스케일 파일**: Supabase Storage 직접 백업
2. **50-200MB 파일**: 압축 후 백업 시도
3. **200MB+ 파일**: 메타데이터만 백업 (URL, 생성일, 모델 정보)

### 장기 해결책
1. **압축 백업 시스템 구축**
   - FFmpeg 기반 자동 압축
   - 원본 품질 유지하면서 크기 50% 감소
   
2. **하이브리드 스토리지**
   - 작은 파일: Supabase Storage
   - 큰 파일: 외부 클라우드 (S3 등)
   - 메타데이터: Supabase Database

3. **백업 우선순위 시스템**
   - 최신 파일 우선 백업
   - 오래된 파일은 압축 백업
   - 액세스 빈도에 따른 저장소 선택

## 📋 즉시 실행할 작업

### Phase 1: 가능한 파일 백업
- [ ] 50MB 미만 업스케일 파일 백업 (즉시 가능)
- [ ] 메타데이터 백업 (모든 업스케일 파일)

### Phase 2: 압축 백업 시스템
- [ ] FFmpeg 압축 함수 개발
- [ ] 테스트용 압축 백업 실행
- [ ] 압축률과 품질 검증

### Phase 3: 대용량 파일 처리
- [ ] 외부 스토리지 연동 검토
- [ ] 비용 효율성 분석
- [ ] 백업 전략 최종 결정

## ⚠️ 중요 고려사항

1. **FAL AI 7일 제한**: 가장 오래된 파일부터 우선 처리
2. **비용 효율성**: 장기 저장 비용 vs 재생성 비용
3. **접근성**: 백업된 파일의 접근 편의성
4. **자동화**: 향후 생성되는 파일의 자동 백업

## 💡 결론

**즉시 실행**: 50MB 미만 파일 백업, 메타데이터 백업
**단기 목표**: 압축 백업 시스템 개발
**장기 목표**: 하이브리드 클라우드 스토리지 전략